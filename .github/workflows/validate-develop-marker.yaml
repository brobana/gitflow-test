name: Ensure Develop Branch Has Marker

on:
  push:
    branches: [develop]
    workflow_dispatch: {}    # allow manual run, optional

jobs:
  ensure-develop-branch-has-marker:
    name: Validate Develop Marker File
    runs-on: ubuntu-latest

    steps:
      - name: Checkout PR source branch
        uses: actions/checkout@v3
        with:
          fetch-depth: 0  # Ensure full history is fetched

      - name: Check for marker file existence
        run: |
          MARKER=".github/branch-marker/develop-branch.txt"

          echo "Checking for marker file: $MARKER"

          if [ ! -f "$MARKER" ]; then
            echo "FAILED: Marker file is missing from the develop branch!"
            echo "This indicates the branch may have been overwritten, recreated, or force-pushed."
            echo "Please create the marker file!"
            echo "File: $MARKER"
            echo "Content: \"DEVELOP BRANCH â€” DO NOT MERGE INTO OTHER BRANCHES\""
            exit 1
          fi

          echo "PASSED: Marker file exists. Develop branch is healthy."
